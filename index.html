<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Python Learning Platform</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/python/python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/skulpt/dist/skulpt.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/skulpt/dist/skulpt-stdlib.js"></script>

<style>
body{margin:0;font-family:system-ui;background:#1e1e1e;color:#e5e7eb}
header{padding:16px;text-align:center;font-size:24px;color:#38bdf8}
main{padding:12px}
.compiler{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.CodeMirror,#console,#inputBox{
  height:600px;
  width:100%;
  background:#1e1e1e;
  color:#f8f8f2;
  border-radius:10px;
  font-size:15px;
  caret-color:#ffffff;
}
button{margin-top:10px;padding:10px 16px;border:none;border-radius:8px;background:#22c55e;color:#052e16;font-size:15px;cursor:pointer}
button:hover{background:#16a34a}
#quiz button{margin:6px}
#score{margin-top:10px;color:#4ade80;font-weight:bold}
#inputBox{height:40px;padding:8px;}
</style>
</head>
<body>

<header>Python Learning Platform</header>

<main>
<section class="compiler">
  <div>
    <h2>Python Editor</h2>
    <textarea id="code">print("Hello World")
name = input("Enter your name: ")
print(f"Hello {name}")</textarea>
    <button id="runBtn">Run</button>
  </div>

  <div>
    <h2>Console (Input & Output)</h2>
    <textarea id="console" placeholder="Program output will appear here" readonly></textarea>
    <input type="text" id="inputBox" placeholder="Type input here">
    <button id="submitInput">Submit Input</button>
  </div>
</section>

<section>
  <h2>Python Quiz</h2>
  <div id="quiz-container">
    <button id="startQuizBtn">Start Quiz</button>
    <div id="quiz"></div>
    <div id="score"></div>
  </div>
</section>
</main>

<script>
// Setup CodeMirror
const editor = CodeMirror.fromTextArea(document.getElementById('code'), {
  mode:'python',
  lineNumbers:true,
  theme:'dracula'
});
editor.setSize('100%','600px');

let inputQueue = [];
let consoleEl = document.getElementById('console');

function outf(text){ consoleEl.value += text+"\n"; }

function builtinInput(prompt){
  return new Promise(resolve=>{
    consoleEl.value += prompt;
    inputQueue.push(resolve);
  });
}

document.getElementById('submitInput').addEventListener('click',()=>{
  if(inputQueue.length>0){
    inputQueue.shift()(document.getElementById('inputBox').value);
    document.getElementById('inputBox').value="";
  }
});

function runCode(){
  consoleEl.value="";
  let prog = editor.getValue();
  Sk.configure({
    output:outf,
    read:function(x){return Sk.builtinFiles["files"][x];},
    input: builtinInput
  });
  (Sk.misceval.asyncToPromise(()=>Sk.importMainWithBody("<stdin>",false,prog,true))).catch(err=>consoleEl.value += "\nError:\n"+err);
}

document.getElementById('runBtn').addEventListener('click',runCode);

// Quiz logic
const questions=[
['What does print() do?', ['Show output','Take input','Stop code'],0],
['Which is a loop?', ['if','for','print'],1],
['Which is correct?', ['x=5','5=x','int x'],0],
['What symbol starts comments?', ['#','//','--'],0],
['Which stores many values?', ['list','int','str'],0],
['What gets user input?', ['print','input','len'],1],
['Which is Python?', ['Game','Language','Browser'],1],
['Indentation is for?', ['Speed','Blocks','Comments'],1],
['Which prints text?', ['say','print','echo'],1],
['Which runs code?', ['Run','Compile','Execute'],2]
];
let qIndex=0,score=0;
function startQuiz(){qIndex=0;score=0;document.getElementById('score').textContent='';showQuestion();}
function showQuestion(){const q=questions[qIndex];let html=`<p>${qIndex+1}. ${q[0]}</p>`;q[1].forEach((c,i)=>{html+=`<button onclick="answer(${i})">${c}</button>`});document.getElementById('quiz').innerHTML=html;}
function answer(i){if(i===questions[qIndex][2])score++;qIndex++;if(qIndex<questions.length){showQuestion();}else{document.getElementById('quiz').textContent='Quiz Finished';document.getElementById('score').textContent=`Score: ${score}/10`;}}
document.getElementById('startQuizBtn').addEventListener('click',startQuiz);
</script>
</body>
</html>
